<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="./styles/style.css" />
    <title> Calculator </title>
    <link rel="icon" href="./images/calculator-icon.jpg" type="image/x-icon">
</head>

<body> 
    <div class="calculator">
        <div class="screenBody">
            <div class="screen">  
                <input class="screenText1" type="text" value="" disabled /> <br>
                <input class="screenText2" type="text" disabled /> 
            </div>
        </div>

        <div class="mainBody">
            <button class="sqrt" onclick='operate("sqrt")'> 
                &radic;<span style="text-decoration:overline;">&nbsp;&nbsp;</span> 
            </button>
            <button class="seven" onclick='operate("7")'> 7 </button> 
            <button class="eight" onclick='operate("8")'> 8 </button> 
            <button class="nine" onclick='operate("9")'> 9 </button>
            <button class="divide" onclick='operate("/")'> ÷ </button>  <br>
            <button class="negation" onclick='operate("neg")'> +/− </button>
            <button class="four" onclick='operate("4")'> 4 </button>
            <button class="five" onclick='operate("5")'> 5 </button> 
            <button class="six" onclick='operate("6")'> 6 </button>
            <button class="multiply" onclick='operate("*")'> × </button> <br>
            <button class="delete" onclick='operate("del")'> Del </button>
            <button class="one" onclick='operate("1")'> 1 </button>
            <button class="two" onclick='operate("2")'> 2 </button>
            <button class="three" onclick='operate("3")'> 3 </button>
            <button class="minus" onclick='operate("-")'> − </button> <br>
            <button class="clear" onclick='operate("ce")'> CE </button>
            <button class="zero" onclick='operate("0")'> 0 </button>
            <button class="dot" onclick='operate(".")'> . </button>
            <button class="equals" onclick='operate("=")'> = </button>
            <button class="plus" onclick='operate("+")'> + </button>
        </div>
    </div>

    <script>
        var dotPressed = false;
        var operator = "";
        var firstNum = 0;
        var secondNum = 0;

        function operate(key)
        {
            var secondScreen = document.getElementsByClassName("screenText2")[0].value;
            if (key == "=")
            {
                if (operator.length != 0)
                {
                    var num = Number(document.getElementsByClassName("screenText2")[0].value);
                    secondNum = Number(num.toFixed(2));
                    document.getElementsByClassName("screenText1")[0].value += secondNum.toString();
                    secondNum = Number(secondScreen);
                    calculate();
                    fixDecimal();
                }
            } else if (key == "+" || key == "-" || key == "*" || key == "/") {

                if (operator.length != 0)   // there is an active operator
                {
                    
                } 
                  
                if (operator.length == 0 && secondScreen.length != 0)   // no active operator
                {
                    operator = key;
                    dotPressed = false;
                    firstNum = Number(secondScreen);
                    fixDecimal();
                    document.getElementsByClassName("screenText1")[0].value = firstNum;
                    if (key == "+")
                    {
                        document.getElementsByClassName("screenText1")[0].value += " + ";
                    } else if (key == "-") {
                        document.getElementsByClassName("screenText1")[0].value += " − ";
                    } else if (key == "*") { 
                        document.getElementsByClassName("screenText1")[0].value += " × ";
                    } else {
                        document.getElementsByClassName("screenText1")[0].value += " ÷ ";
                    }
                    document.getElementsByClassName("screenText2")[0].value = "";
                }
            } else if (key == "sqrt" || key == "neg") {
                firstNum = Number(secondScreen);
                if (operator == "")
                {
                    if (key == "sqrt" && firstNum >= 0)
                    {
                        document.getElementsByClassName("screenText1")[0].value 
                            = '√' + firstNum.toString();
                        document.getElementsByClassName("screenText2")[0].value = Math.sqrt(firstNum);
                        fixDecimal();
                    } 

                    if (key == "sqrt" && firstNum < 0)
                    {
                        document.getElementsByClassName("screenText1")[0].value = "ERROR: SQRT < 0";
                        document.getElementsByClassName("screenText2")[0].value = "";
                        firstNum = 0;
                        secondNum = 0;
                        dotPressed = false;
                        operator = "";
                    }

                    if (key == "neg" && firstNum > 0)
                    {
                        firstNum = firstNum * -1;
                        document.getElementsByClassName("screenText2")[0].value 
                            = "-" + secondScreen;
                    }
                }
            } else if (key == "del") {

            } else if (key == "ce") {
                dotPressed = false;
                operator = "";
                firstNum = 0;
                secondNum = 0;
                document.getElementsByClassName("screenText1")[0].value = "";
                document.getElementsByClassName("screenText2")[0].value = "";
            } else {
                if (key == ".") 
                {
                    if (!dotPressed && secondScreen.length != 0)    // decimal dot can be pressed only once
                    {
                        document.getElementsByClassName("screenText2")[0].value += key;
                        dotPressed = true;
                    }
                } else {
                    if (key != "0" || secondScreen != "0") // cannot spam 0's in front
                    {
                        document.getElementsByClassName("screenText2")[0].value += key;
                        secondScreen = document.getElementsByClassName("screenText2")[0].value;
                        if (secondScreen.substring(0,1) == "0" && secondScreen.substring(1,2) != "." &&
                        secondScreen.length > 1) // remove 0 in front
                        {
                            document.getElementsByClassName("screenText2")[0].value = secondScreen.substring(1, secondScreen.length);
                        }
                    }
                }
            }
        }

        function fixDecimal()
        {
            var num = Number(document.getElementsByClassName("screenText2")[0].value);
            document.getElementsByClassName("screenText2")[0].value = num.toFixed(2);
            firstNum = Number(num.toFixed(2));
        }

        function calculate()
        {
            var calculatedNum

            if (operator == "+")
            {
                calculatedNum = firstNum + secondNum;
            } else if (operator == "-") {
                calculatedNum = firstNum - secondNum;
            } else if (operator == "*") {
                calculatedNum = firstNum - secondNum;
            } else if (operator == "/") { 
                if (secondNum == 0)
                {
                    document.getElementsByClassName("screenText1")[0].value = "ERROR: 0 DENOM";
                    document.getElementsByClassName("screenText2")[0].value = "";
                    firstNum = 0;
                    secondNum = 0;
                    dotPressed = false;
                    operator = "";
                    return;
                } else {
                    calculatedNum = firstNum / secondNum;
                }
            }
 
            document.getElementsByClassName("screenText2")[0].value = calculatedNum;
            operator = "";
            firstNum = calculatedNum;
            secondNum = 0;
            dotPressed = false;
        }
    </script>
</body>

</html>